<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/gold-email-input/gold-email-input.html">
<link rel="import" href="../bower_components/gold-phone-input/gold-phone-input.html">
<link rel="import" href="../bower_components/iron-form/iron-form.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/polymerfire/polymerfire.html">
<link rel="import" href="../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../bower_components/paper-menu-button/paper-menu-button.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-toast/paper-toast.html">
<link rel="import" href="shared-styles.html">

<dom-module id="cgi-register">
    <template>
        <style include="shared-styles">
            :host {
                display: block;
                height: 100%;
                position: relative;
                overflow-y: auto;
                padding: 10px;
            }
            paper-input{
                --paper-input-container:{width:25em;};
            }
            paper-textarea{
                --paper-input-container:{width:25em;};
            }
            gold-email-input{
                --paper-input-container:{width:25em;};
            }
            paper-dropdown-menu, paper-listbox {
                width: 250px;
            }
            paper-dropdown-menu {
                margin: auto;
            }
            paper-button {
                background: #ac3535;
                color: white;
            }
            .buttons {
                @apply(--layout-horizontal);
                @apply(--layout-center);
            }
            #toast1 {
                --paper-toast-background-color: lime;
                --paper-toast-color: black;
            }
            #toast0 {
                --paper-toast-background-color: #ac3535;
                --paper-toast-color: white;
            }
        </style>

        <firebase-query
                id = "query"
                path = "/users"
                data = "{{users}}">
        </firebase-query>

        <!-- https://github.com/StickmanVentures/real-time-contact/blob/master/real-time-contact.html -->
        <form is="iron-form" id="form" disable-native-validation-ui>

            <paper-input label="Voornaam"
                         required
                         auto-validate
                         value={{formData.firstName}}
                         error-message="Please fill out this field.">
            </paper-input>

            <paper-input label="Achternaam"
                         required
                         auto-validate
                         value="{{formData.lastName}}"
                         error-message="Please fill out this field.">
            </paper-input>

            <br>

            <paper-checkbox checked="{{formData.dutch}}">Nederlands</paper-checkbox>

            <paper-checkbox checked="{{formData.english}}">Engels</paper-checkbox>

            <!--<gold-phone-input label="Telefoonnummer"
                              required
                              auto-validate
                              value="{{formData.telno}}"
                              country-code="31"
                              phone-number-pattern="X-XXXX-XXXX">
            </gold-phone-input>-->

            <paper-input label="Telefoonnummer"
                         required
                         auto-validate
                         value="{{formData.telno}}"
                         allowed-pattern="[0-9-+]"
                         maxlength="14"
                         placeholder="06-12345678">
            </paper-input>

            <gold-email-input label="Email-adres"
                              required
                              auto-validate
                              value="{{formData.email}}"
                              error-message="Please enter a valid email"
                              autocomplete="email"
                              placeholder="me@example.com">
            </gold-email-input>

            <paper-input label="LinkedIn URL"
                         value="{{formData.linkedinUrl}}">
            </paper-input>

            <br>
            <paper-input label="Hoogste Kwalificatie"
                         value="{{formData.highestQualification}}">
            </paper-input>

            <paper-input label="Afstudeer Jaar"
                         value="{{formData.graduationYear}}"
                         auto-validate
                         allowed-pattern="[0-9]"
                         placeholder="2000"
                         maxlength="4">
            </paper-input>

            <paper-input label="Gecertificeerd in de laatste drie jaar"
                         value="{{formData.certified}}">
            </paper-input>

            <paper-input label="Huidige Rol"
                         value="{{formData.currentRole}}">
            </paper-input>

            <paper-input label="Rol Geintresseerd"
                         value="{{formData.preferredRole}}">
            </paper-input>

            <paper-dropdown-menu label="Voorkeur Locatie"
                                 value="{{formData.preferredLocation}}">
                <paper-listbox class="dropdown-content">
                    <paper-item>Hoofddorp</paper-item>
                    <paper-item>Rotterdam</paper-item>
                    <paper-item>Groningen</paper-item>
                    <paper-item>Arnhem</paper-item>
                    <paper-item>Maastricht</paper-item>
                    <paper-item>Eindhoven</paper-item>
                </paper-listbox>
            </paper-dropdown-menu>

            <br>

            <paper-dropdown-menu label="Voorkeur voor Sector"
                                 value="{{formData.preferredSector}}">
                <paper-listbox class="dropdown-content">
                    <paper-item>Banking</paper-item>
                    <paper-item>Insurance</paper-item>
                    <paper-item>Government</paper-item>
                    <paper-item>Health</paper-item>
                    <paper-item>Manufacturing</paper-item>
                    <paper-item>Retail</paper-item>
                    <paper-item>Oil</paper-item>
                    <paper-item>Gas</paper-item>
                    <paper-item>Communications</paper-item>
                    <paper-item>Telecomunications</paper-item>
                    <paper-item>Service Delivery</paper-item>
                    <paper-item>Gis</paper-item>
                    <paper-item>Space</paper-item>
                    <paper-item>Defence</paper-item>
                    <paper-item>Transport</paper-item>
                    <paper-item>Logistics</paper-item>
                    <paper-item>None</paper-item>
                </paper-listbox>
            </paper-dropdown-menu>

            <br>

            <paper-button on-tap="toggleSkillsDialog">Vaardigheden</paper-button>
            <paper-dialog id="skillsDlg">
                <paper-listbox class="dropdown-content"
                               selected-values="{{formData.skills}}"
                               attr-for-selected="name"
                               multi>
                    <paper-item name="Cloud">Cloud</paper-item>
                    <paper-item name="Big Data">Big Data</paper-item>
                    <paper-item name="Esri">Esri</paper-item>
                    <paper-item name="UX">UX</paper-item>
                    <paper-item name="GEO">GEO</paper-item>
                    <paper-item name="Citrix">Citrix</paper-item>
                    <paper-item name="Functioneel testen">Functioneel testen</paper-item>
                    <paper-item name="Smallworld">Smallworld</paper-item>
                    <paper-item name="Java">Java</paper-item>
                    <paper-item name="Red Hat">Red Hat</paper-item>
                    <paper-item name="Linux">Linux</paper-item>
                    <paper-item name="LAN">LAN</paper-item>
                    <paper-item name="WAN">WAN</paper-item>
                    <paper-item name="Tibco">Tibco</paper-item>
                    <paper-item name="SOA">SOA</paper-item>
                    <paper-item name="IOS">IOS</paper-item>
                    <paper-item name="MES">MES</paper-item>
                    <paper-item name="MS Cloud">MS Cloud</paper-item>
                    <paper-item name="Pega">Pega</paper-item>
                    <paper-item name="SAP">SAP</paper-item>
                    <paper-item name="">Microsoft</paper-item>
                    <paper-item name="Microsoft">SAP HANA</paper-item>
                    <paper-item name="AP Hybris">SAP Hybris</paper-item>
                    <paper-item name="SAP ME">SAP ME</paper-item>
                    <paper-item name="Cyber security">Cyber security</paper-item>
                    <paper-item name="Technisch testen">Technisch testen</paper-item>
                    <paper-item name="Agile">Agile</paper-item>
                    <paper-item name="Bleuriq">Bleuriq</paper-item>
                    <paper-item name="C#">C#</paper-item>
                    <paper-item name=".Net">.Net</paper-item>
                    <paper-item name="ETL">ETL</paper-item>
                </paper-listbox>
            </paper-dialog>

            <br>

            <paper-dropdown-menu label="Contact Persoon">
                <paper-listbox class="dropdown-content"
                               value="{{formData.contact}}"
                               attr-for-selected="name">
                    <template is="dom-repeat" items="[[users]]" as="user">
                        <paper-item name$="[[user.displayName]]">[[user.displayName]]</paper-item>
                        <!--<paper-item data-category$="{{users.displayName}}" label$="{{item.displayName}}"></paper-item>-->
                    </template>
                </paper-listbox>
            </paper-dropdown-menu>

            <br>

            <paper-dropdown-menu label="Groep">
                <paper-listbox class="dropdown-content"
                               value="{{formData.group}}">
                    <paper-item>A</paper-item>
                    <paper-item>B</paper-item>
                    <paper-item>C</paper-item>
                </paper-listbox>
            </paper-dropdown-menu>

            <paper-textarea label="Opmerkingen"
                            value="{{formData.remarks}}">
            </paper-textarea>

            <br>

            <paper-button on-tap="toggleDialog">Privacy Disclaimer</paper-button>
            <paper-dialog id="privacyDlg">
                <p><h3>Personal information collation statement</h3></p><p><b>Conditions for use of the Recruitment Event Registration Tool CGI Netherlands B.V. (Hereinafter CGI). </b></p><p>Your personal information will be considered confidential information and that information is used only for the purpose described below.</p><p>CGI is committed to the Dutch and European legislation on the use of personal data.</p><p><b>The purpose of the use of your data.</b></p><p>The purpose of the use of your personal data in the CGI Recruitment Event Registration Tool is to ease the chance of a career at CGI and to stay informed of our recruitment events. </p><p><b>Update and delete your personal data. </b></p><p>You can always remove your personal information from our database. That responsibility we leave to you. We will keep your data for a maximum period of one year or until you previously indicate that it is no longer desirable. </p><p>By accepting this statement you consent to saving your personal information.</p>
            </paper-dialog>

            <paper-checkbox checked="{{formData.disclaimer}}">Akkoord</paper-checkbox>

            <br>
            <br>

            <paper-checkbox checked="{{formData.newsLetter}}">Abonneren op de Nieuwsbrief</paper-checkbox>

            <br>
            <br>

            <div class="buttons">
                <paper-button on-tap="resetForm">Reset</paper-button>
                <paper-button on-tap="submitForm">Submit</paper-button>
            </div>

            <br>
            <br>

        </form>
        <paper-toast id="toast0" text="Please Complete Mandatory Fields"></paper-toast>
        <paper-toast id="toast1" text="Saved"></paper-toast>
    </template>

    <script>
        Polymer({
            is: 'cgi-register',
            properties:{
                formData: {
                    type: Object,
                    value: function(){
                        return {
                            linkedinUrl: 'https://www.linkedin.com/in/',
                            skills:[]
                        };
                    }
                },
                users: {
                    type: Array
                },
                skills:{
                    type:Array,
                    notify:true
                }
            },
            toggleDialog: function() {
                this.$.privacyDlg.toggle();
            },
            toggleSkillsDialog: function() {
                this.$.skillsDlg.toggle();
            },

            resetForm: function() {
                this.$.form.reset();
            },

            submitForm: function() {
                var self = this;
                if(!this.$.form.validate()) {
                    this.$.toast0.open();
                    return;
                }


                firebase.database().ref('/candidates').push(this.formData).then(function(res){
                    self.$.toast1.open();
                    self.$.form.reset();
                });
            },
        });
    </script>
</dom-module>
